"use strict";var appendPrefixPreventingSubstitutionByGruntReplaceAndUglify=function(a){return"@@"+a},variableNameThatShouldNotBeReplaced=appendPrefixPreventingSubstitutionByGruntReplaceAndUglify("___ENV_REPLACE_WORKAROUND___"),replaceTaskInvoked="42"!==variableNameThatShouldNotBeReplaced;angular.module("amvGeolocationUi",["ngAnimate","ngCookies","ngMessages","ngSanitize","ngTouch","ui.router","ui-leaflet","knalli.angular-vertxbus","js-data"]).factory("Materialize",["$window",function(a){return a.Materialize}]).factory("amvTrafficsoftRestJs",["$window",function(a){return a.amvTrafficsoftRestJs}]).factory("DSLocalForageAdapter",["$window",function(a){return a.DSLocalForageAdapter}]).run(["DS","DSLocalForageAdapter",function(a,b){var c=new b;a.registerAdapter("localForage",c,{"default":!0})}]).factory("SettingsResource",["DS",function(a){return a.defineResource("SettingsResource")}]).factory("amvApplicationInfo",[function(){return replaceTaskInvoked?{version:"app"}:{version:"dev"}}]).factory("amvGitInfo",function(){return replaceTaskInvoked?{local:{branch:{shortSHA:"580f16c",name:"master",lastCommitNumber:"11"}},remote:{origin:{url:"https://github.com/amvnetworks/amv-trafficsoft-geolocation-app.git"}}}:{local:{branch:{shortSHA:"${shortSHA}",name:"${branchName}",lastCommitNumber:"${lastCommitNumber}"}},remote:{origin:{url:"${remoteUrl}"}}}}).factory("amvClientSettingsTemplate",function(){return{api:{baseUrl:"http://www.example.com",options:{contractId:1,auth:{username:"username",password:"password"},vehicleIds:[1,2,3]}},showPositionFetchedInRealtime:!1,positionUpdateIntervalInSeconds:10,debug:!1}}).factory("amvClientSettings",["SettingsResource",function(a){return{get:function(){return a.findAll().then(function(a){if(1!==a.length)throw new Error("Cannot find settings.");return a[0]})}}}]).factory("amvClientFactory",["amvTrafficsoftRestJs","amvClientSettings",function(a,b){return{get:function(){return b.get().then(function(a){return a.api}).then(function(b){return a(b.baseUrl,b.options)})}}}]).factory("amvXfcdClient",["amvClientFactory",function(a){return{get:function(){return a.get().then(function(a){return a.xfcd()})}}}]).config(["vertxEventBusProvider",function(a){a.enable().useReconnect().useUrlServer("http://geolocation.amv-networks.com").useUrlPath("/eventbus")}]).config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/home"),a.state("home",{url:"/home",templateUrl:"views/page/main.html",controller:"MainCtrl",controllerAs:"main"}).state("settings",{url:"/settings",templateUrl:"views/page/settings.html",controller:"SettingsCtrl",controllerAs:"settings"}).state("about",{url:"/about",templateUrl:"views/page/about.html",controller:"AboutCtrl",controllerAs:"about"})}]).controller("TopNavigationController",["amvGitInfo",function(a){this.gitinfo=angular.copy(a)}]),angular.module("amvGeolocationUi").controller("MainCtrl",["$scope","$log","Materialize","amvClientSettings","amvXfcdClient",function(a,b,c,d,e){function f(a){return{name:a.id,location:{lat:a.latitude,lng:a.longitude},provider:"amv networks",requestTime:Date.now(),date:Date.now(),data:a}}var g=this;this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],this.map={center:{lat:49,lng:10,zoom:3},markers:[],events:{},defaults:{scrollWheelZoom:!0,center:{lat:49,lng:10,zoom:5}},tiles:{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"},controls:{fullscreen:{position:"topleft"}}},a.$watch(function(){return g.map.center.zoom},function(a){g.map.tiles.url=a>6?"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png":"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"});var h=function(a){var b="<div><h6>"+a.name+'</h6><small><i class="material-icons tiny">room</i> lat/lng: '+a.location.lat+" / "+a.location.lng+'</small><br /><small> <i class="material-icons tiny">av_timer</i> speed: '+(a.data.speed||0)+'km/h</small><br /><span></span><br /><small><i class="material-icons tiny">router</i> Data Provider: '+a.provider+'</small><br /><small><i class="material-icons tiny">query_builder</i> Request Time: '+a.requestTime+'</small><br /><small><i class="material-icons tiny">query_builder</i> Position Time: '+a.data.timestamp+"</small></div>";return{lat:a.location.lat,lng:a.location.lng,message:b,draggable:!1,icon:{iconSize:[48,48],iconAnchor:[24,24],popupAnchor:[0,0]}}},i=function(a){var b=!!(a.location&&a.location.lat&&a.location.lng);if(b){var c=h(a);g.map.markers.push(c)}};a.$on("leafletDirectiveMap.mymap.click",function(a,c){var d=c.leafletEvent,e={location:{lat:d.latlng.lat,lng:d.latlng.lng}};b.log("clicked "+e)}),a.zoomToLocation=function(a,b){var d=b>0?b:11,e=a.location,f=!!(e&&e.lat&&e.lng);f?(c.toast("Zoom to "+a.name,1e3),g.map.center={lat:e.lat,lng:e.lng,zoom:d}):c.toast("No location data available for "+a.name,2e3)},function(){a.loading=!0,a.locations=[],d.get().then(function(a){return g.settings=a,a.api||{}}).then(function(a){return a.options.vehicleIds||[]}).then(function(d){e.get().then(function(a){return a.getLastData(d)}).then(function(d){b.log("ok, got data");var e=!d.data||0===d.data.length;if(e)c.toast("Response contains empty data!",2e3);else{var g=d.data;g.forEach(function(b){var c=f(b);a.locations.push(c),i(c)}),c.toast("Finished loading "+g.length+" location(s)",1e3)}})["catch"](function(a){b.log("error, while getting data"),b.log(a);var d=a&&a.response&&a.response.data&&a.response.data.message,e=d?a.response.data.message:a;c.toast(e,4e3),c.toast("Please check your settings.",5e3)})["finally"](function(){a.loading=!1})})["catch"](function(d){b.log(d),a.loading=!1,c.toast("Please check your settings.",3e3)})}()}]),angular.module("amvGeolocationUi").controller("SettingsCtrl",["Materialize","SettingsResource","amvClientSettingsTemplate",function(a,b,c){var d=this,e=c;b.findAll().then(function(a){0!==a.length?d.config=angular.copy(a[0]):b.create(e).then(function(a){d.config=angular.copy(a)})}),this.saveSettings=function(c){b.destroyAll().then(function(){b.create(c).then(function(b){d.config=angular.copy(b),a.toast("Settings saved!",3e3)})})},this.loadDefaultSettings=function(){d.config=angular.copy(e)},this.addValueToVehicleIds=function(a){a&&a>0&&d.config.api.options.vehicleIds.push(a)},this.onKeyUpOnNewVehicleIdInput=function(a,b){var c=13===a.keyCode;c&&d.addValueToVehicleIds(b)},this.removeVehicleIdWithValue=function(a){var b=d.config.api.options.vehicleIds.indexOf(a);b>=0&&d.config.api.options.vehicleIds.splice(b,1)}}]),angular.module("amvGeolocationUi").controller("AboutCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("amvGeolocationUi").run(["$templateCache",function(a){a.put("views/page/about.html",'<div class="container"> <div class="section"> <div class="row"> <div class="col s12 m12"> <p>This is the about view.</p> </div> </div> </div> </div>'),a.put("views/page/data-details.html",'<div class="container"> <div class="section"> <div class="row"> <div class="col s12 m12"> <p>This is the about view.</p> </div> </div> </div> </div>'),a.put("views/page/main.html",'<div class="progress amber" style="margin: 0" data-ng-show="loading"> <div class="indeterminate amber lighten-4"></div> </div> <div class="row" style="margin-bottom: 0"> <div class="col s6 m4 l3" style="padding: 0"> <div style="height: 600px; overflow-y: scroll; overflow-x: hidden"> <form class=""> <div class="input-field col s12"> <input placeholder="" id="filterInput" type="text" data-ng-model="filterInput"> <label for="filterInput">Filter</label> </div> </form> <div class="collection"> <a class="collection-item avatar" data-ng-repeat="geolocation in locations | filter:filterInput" href="#!" data-ng-click="zoomToLocation(geolocation)"> <i class="material-icons circle amber">track_changes</i> <span class="badge">{{$index + 1}}</span> <p> {{ geolocation.name }} </p> <ul> <li> <i class="material-icons tiny">room</i> <small data-ng-show="geolocation.location.lat && geolocation.location.lng"> lat/lng: {{ geolocation.location.lat }} / {{ geolocation.location.lng }} </small> <small data-ng-hide="geolocation.location.lat && geolocation.location.lng"> lat/lng: No location data available. </small> </li> <li> <i class="material-icons tiny">av_timer</i> <small> speed: {{ geolocation.data.speed || 0 }} km/h </small> </li> </ul> <div data-ng-if="main.settings.debug"> {{ geolocation.data | json }} </div> <!--ul>\n            <li data-ng-repeat="xfcd in geolocation.data.xfcds">\n\n              <div>\n                <i class="material-icons tiny">label</i>\n                {{ xfcd.param }}\n                <span>{{ xfcd.value }}</span></div>\n            </li>\n          </ul--> </a> </div> </div> </div> <div class="col s6 m8 l9" style="padding: 0"> <leaflet id="mymap" defaults="main.map.defaults" center="main.map.center" markers="main.map.markers" tiles="main.map.tiles" height="600px"> </leaflet> </div> </div>'),a.put("views/page/settings.html",'<div class="container"> <div class="section"> <div class="row"> <div class="col s12 m12"> <h2 class="header light"> Settings <a class="waves-effect waves-light btn-large amber right" data-ng-click="settings.saveSettings(settings.config)"> <i class="material-icons left">done</i> Save </a> </h2> <div class="col s12"> <h3 class="header light">API Settings</h3> <ul class="collection"> <li class="collection-item"> <div class="input-field"> <input id="baseUrl" type="text" class="validate" data-ng-model="settings.config.api.baseUrl"> <label class="active" for="baseUrl">Base URL</label> </div> <div class="row" style="margin-bottom: 0"> <div class="input-field col s6"> <input id="username" type="text" class="validate" data-ng-model="settings.config.api.options.auth.username"> <label class="active" for="username">Username</label> </div> <div class="input-field col s6"> <input id="password" type="password" class="validate" data-ng-model="settings.config.api.options.auth.password"> <label class="active" for="password">Password</label> </div> </div> <div class="input-field"> <input id="contractId" type="number" class="validate" data-ng-model="settings.config.api.options.contractId"> <label class="active" for="contractId">ContractId</label> </div> <h6>Vehicle Ids</h6> <div class="chip" data-ng-repeat="vehicleId in settings.config.api.options.vehicleIds track by $index"> {{ vehicleId }} <i class="material-icons" data-ng-click="settings.removeVehicleIdWithValue(vehicleId)" style="cursor: pointer">close</i> </div> <div class="file-field input-field"> <div class="waves-effect waves-light btn right" data-ng-click="settings.addValueToVehicleIds(__newVehicleId); __newVehicleId = null;"> Add </div> <div class="file-path-wrapper"> <input id="__newVehicleId" type="number" class="validate" data-ng-model="__newVehicleId" data-ng-keyup="settings.onKeyUpOnNewVehicleIdInput($event, __newVehicleId)"> <label class="active" for="__newVehicleId">Add VehicleId</label> </div> </div> </li> </ul> <h3 class="header light">Application Settings</h3> <ul class="collection"> <li class="collection-item" style="cursor: pointer" data-ng-class="{ \'grey lighten-3\' : settings.optOut }" data-ng-click="settings.toggleOptOut()"> <span class="title">Realtime position updates</span> <div class="switch right"> <label> Aus <input type="checkbox" data-ng-model="settings.config.showPositionFetchedInRealtime" data-ng-true-value="true" data-ng-false-value="false" data-ng-change-disabled="settings.doOnStateChange()"> <span class="lever"></span> Ein </label> </div> <p data-ng-if="settings.config.showPositionFetchedInRealtime"> Realtime geolocation information updates are <strong class="green-text">enabled</strong>! Recently fetched geolocation information will be displayed in your map. </p> <p data-ng-if="!settings.config.showPositionFetchedInRealtime"> Realtime geolocation information updates are <strong class="grey-text">disabled</strong>! Currently no recently fetched geolocation information will be displayed. </p> </li> <li class="collection-item"> <div class="input-field"> <input id="positionUpdateIntervalInSeconds" type="number" class="validate" data-ng-model="settings.config.positionUpdateIntervalInSeconds" data-ng-disabled="settings.config.showPositionFetchedInRealtime"> <label class="active" for="positionUpdateIntervalInSeconds">Position Update Interval In Seconds</label> </div> </li> <li class="collection-item" style="cursor: pointer" data-ng-class="{ \'grey lighten-3\' : settings.optOut }" data-ng-click="settings.toggleOptOut()"> <span class="title">Debug Mode</span> <div class="switch right"> <label> Aus <input type="checkbox" data-ng-model="settings.config.debug" data-ng-true-value="true" data-ng-false-value="false" data-ng-change-disabled="settings.doOnStateChange()"> <span class="lever"></span> Ein </label> </div> <p data-ng-if="settings.config.debug"> Debug Mode is <strong class="green-text">enabled</strong>! The application will output and display more fine grained messages. </p> <p data-ng-if="!settings.config.debug"> Debug Mode is <strong class="grey-text">disabled</strong>! The application will NOT output or display detailed messages. </p> </li> </ul> </div> </div> <div class="col s12 m12"> <a class="waves-effect waves-light btn right" data-ng-click="settings.loadDefaultSettings()"> <i class="material-icons left">settings_backup_restore</i> Load default values </a> </div> <div class="col s12 m12"> <p data-ng-if="settings.config.debug"> <code> {{ settings.config | json }} </code> </p> </div> </div> </div> </div>'),a.put("views/partials/footer.html",'<footer class="page-footer bgcolor-brand"> <div class="container"> <div class="row"> <div class="col l6 s12"> <h5 class="white-text">amv Geolocation</h5> <ul> <li><a class="white-text" data-ui-sref="about">About</a></li> <li><a class="white-text" href="https://www.amv-networks.com/en/data-protection/">Privacy</a></li> <li><a class="white-text" href="https://www.amv-networks.com/en/imprint/">Impress</a></li> <li><a class="white-text" href="https://www.amv-networks.com/en/gtc/">Terms and Conditions</a></li> </ul> </div> <div class="col l6 s12"> <!--h5 class="white-text">Company Bio</h5--> <p class="grey-text text-lighten-4"></p> </div> </div> </div> <div class="footer-copyright"> <div class="container"> <p class="left"> made with <i class="material-icons tiny">favorite</i> by <a class="brown-text" href="https://www.amv-networks.com">amv</a> </p> </div> </div> </footer>'),a.put("views/partials/top-navigation.html",'<nav class="white" role="navigation" data-ng-controller="TopNavigationController as topnavigation"> <div class="nav-wrapper container"> <a id="logo-container" href="#/" class="brand-logo"> <span class="amv">amv</span> Geolocation <small style="font-size: 50%"> {{topnavigation.gitinfo.local.branch.name}}-{{topnavigation.gitinfo.local.branch.shortSHA}} </small> </a> <ul class="right hide-on-med-and-down"> <li ui-sref-active="active"><a data-ui-sref="home">Home</a></li> <li ui-sref-active="active"><a data-ui-sref="settings">Settings</a></li> <li ui-sref-active="active"><a data-ui-sref="about">About</a></li> </ul> <ul id="nav-mobile" class="side-nav"> <li ui-sref-active="active"><a data-ui-sref="home">Home</a></li> <li ui-sref-active="active"><a data-ui-sref="settings">Settings</a></li> <li ui-sref-active="active"><a data-ui-sref="about">About</a></li> </ul> <a href="#" data-activates="nav-mobile" class="button-collapse"><i class="material-icons">menu</i></a> </div> </nav> <script>(function ($) {\n    $(function () {\n      $(\'.button-collapse\').sideNav();\n    });\n  })(jQuery);</script>')}]);